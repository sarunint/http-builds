{"version":3,"file":"browser_jsonp.js","sourceRoot":"","sources":["../../../../../packages/http/src/backends/browser_jsonp.ts"],"names":[],"mappings":";;;;;;;;;;;AAQA,OAAO,EAAC,UAAU,EAAC,MAAM,eAAe,CAAC;;AAEzC,IAAI,cAAc,GAAG,CAAC,CAAC;;AACvB,aAAa,UAAU,GAAG,cAAc,CAAC;;AACzC,IAAI,iBAAiB,GAA8B,IAAI,CAAC;;;;AAExD,SAAS,oBAAoB;;IAC3B,MAAM,CAAC,GAAyB,OAAO,MAAM,IAAI,QAAQ,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC;IACxE,IAAI,iBAAiB,KAAK,IAAI,EAAE;QAC9B,iBAAiB,GAAG,CAAC,CAAC,UAAU,CAAC,GAAG,EAAE,CAAC;KACxC;IACD,OAAO,iBAAiB,CAAC;CAC1B;AAID,MAAM,OAAO,YAAY;;;;;IAEvB,KAAK,CAAC,GAAW;;QACf,MAAM,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;QAC9C,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;QACf,OAAO,IAAI,CAAC;KACb;;;;IAED,aAAa,KAAa,OAAO,QAAQ,cAAc,EAAE,EAAE,CAAC,EAAE;;;;;IAE9D,eAAe,CAAC,EAAU,IAAY,OAAO,GAAG,UAAU,IAAI,EAAE,WAAW,CAAC,EAAE;;;;;;IAE9E,gBAAgB,CAAC,EAAU,EAAE,UAAe;;QAC1C,MAAM,WAAW,GAAG,oBAAoB,EAAE,CAAC;QAC3C,WAAW,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC;KAC9B;;;;;IAED,gBAAgB,CAAC,EAAU;;QACzB,MAAM,WAAW,GAAG,oBAAoB,EAAE,CAAC;QAC3C,WAAW,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC;KACxB;;;;;IAGD,IAAI,CAAC,IAAS,IAAI,QAAQ,CAAC,IAAI,CAAC,WAAW,mBAAO,CAAC,IAAI,CAAC,EAAC,CAAC,EAAE;;;;;IAG5D,OAAO,CAAC,IAAS;QACf,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,IAAI,CAAC,UAAU,CAAC,WAAW,mBAAO,CAAC,IAAI,CAAC,EAAC,CAAC;SAC3C;KACF;;;YA/BF,UAAU","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {Injectable} from '@angular/core';\n\nlet _nextRequestId = 0;\nexport const JSONP_HOME = '__ng_jsonp__';\nlet _jsonpConnections: {[key: string]: any}|null = null;\n\nfunction _getJsonpConnections(): {[key: string]: any} {\n  const w: {[key: string]: any} = typeof window == 'object' ? window : {};\n  if (_jsonpConnections === null) {\n    _jsonpConnections = w[JSONP_HOME] = {};\n  }\n  return _jsonpConnections;\n}\n\n// Make sure not to evaluate this in a non-browser environment!\n@Injectable()\nexport class BrowserJsonp {\n  // Construct a <script> element with the specified URL\n  build(url: string): any {\n    const node = document.createElement('script');\n    node.src = url;\n    return node;\n  }\n\n  nextRequestID(): string { return `__req${_nextRequestId++}`; }\n\n  requestCallback(id: string): string { return `${JSONP_HOME}.${id}.finished`; }\n\n  exposeConnection(id: string, connection: any) {\n    const connections = _getJsonpConnections();\n    connections[id] = connection;\n  }\n\n  removeConnection(id: string) {\n    const connections = _getJsonpConnections();\n    connections[id] = null;\n  }\n\n  // Attach the <script> element to the DOM\n  send(node: any) { document.body.appendChild(<Node>(node)); }\n\n  // Remove <script> element from the DOM\n  cleanup(node: any) {\n    if (node.parentNode) {\n      node.parentNode.removeChild(<Node>(node));\n    }\n  }\n}\n"]}